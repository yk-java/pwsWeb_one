<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.glens.pwCloudOs.pm.scene.workers.dao.ProWorkersMapper">
	<resultMap id="BaseResultMap"
		type="com.glens.pwCloudOs.pm.scene.workers.vo.ProWorkers">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="rowid" property="rowid" jdbcType="BIGINT" />
		<result column="COMPANY_CODE" property="companyCode" jdbcType="VARCHAR" />
		<result column="WORKER_CODE" property="workerCode" jdbcType="VARCHAR" />
		<result column="WORKER_NAME" property="workerName" jdbcType="VARCHAR" />
		<result column="GENDER" property="gender" jdbcType="CHAR" />
		<result column="BIRTHDAY" property="birthday" jdbcType="VARCHAR" />
		<result column="CARD_ID" property="cardId" jdbcType="VARCHAR" />
		<result column="ADDRESS" property="address" jdbcType="VARCHAR" />
		<result column="MOBILE" property="mobile" jdbcType="VARCHAR" />
		<result column="PHOTO" property="photo" jdbcType="VARCHAR" />
		<result column="PIC1" property="pic1" jdbcType="VARCHAR" />
		<result column="PIC2" property="pic2" jdbcType="VARCHAR" />
		<result column="PIC3" property="pic3" jdbcType="VARCHAR" />
		<result column="WORKER_CARD" property="workerCard" jdbcType="VARCHAR" />
		<result column="STATUS" property="status" jdbcType="CHAR" />
		<result column="SPOT_CODE" property="spotCode" jdbcType="VARCHAR" />
		<result column="TEAMS" property="teams" jdbcType="VARCHAR" />
		 <result column="WORKER_TYPE" property="workerType" jdbcType="CHAR" />
    <result column="RECORD_STATUS" property="recordStatus" jdbcType="CHAR" />
		<result column="REMARK" property="remark" jdbcType="VARCHAR" />
		<result column="SYS_CREATE_TIME" property="sysCreateTime"
			jdbcType="VARCHAR" />
		<result column="SYS_UPDATE_TIME" property="sysUpdateTime"
			jdbcType="VARCHAR" />
		<result column="SYS_DELETE_TIME" property="sysDeleteTime"
			jdbcType="VARCHAR" />
		<result column="SYS_PROCESS_FLAG" property="sysProcessFlag"
			jdbcType="CHAR" />
	</resultMap>
	
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		rowid, COMPANY_CODE, WORKER_CODE, WORKER_NAME, GENDER, BIRTHDAY,
		CARD_ID, ADDRESS,
		MOBILE, PHOTO, PIC1, PIC2, PIC3, WORKER_CARD, STATUS, SPOT_CODE, TEAMS,WORKER_TYPE, 
    RECORD_STATUS,
		REMARK, SYS_CREATE_TIME,
		SYS_UPDATE_TIME, SYS_DELETE_TIME, SYS_PROCESS_FLAG
	</sql>
	
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from pro_workers
		where rowid = #{rowid,jdbcType=BIGINT}
	</select>
	
	<select id="queryProWorkers" resultMap="BaseResultMap"
		parameterType="map">
		select
		<include refid="Base_Column_List" />
		from pro_workers
		where SYS_PROCESS_FLAG='1'
		<if test="spotCode!=null and spotCode!=''">
		and SPOT_CODE=#{spotCode}
		</if>
	</select>
	
	<select id="queryProWorker" resultType="map"
		parameterType="map">
		select
		<include refid="Base_Column_List" />
		from pro_workers
		where SYS_PROCESS_FLAG='1'
		and  WORKER_CARD IN (
		<foreach collection="workCardList" item="item" separator=",">
		#{item}
		</foreach>
		)
		
	</select>
	
	
	<select id="queryProWorkerByCardNo" resultType="map"
		parameterType="map">
		select
		<include refid="Base_Column_List" />
		from pro_workers
		where SYS_PROCESS_FLAG='1'
		and  WORKER_CARD =#{workerCard}
	</select>
	
	
	
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		delete from pro_workers
		where rowid = #{rowid,jdbcType=BIGINT}
	</delete>
	
	<delete id="deleteWorker" parameterType="map">
		update  pro_workers  set SPOT_CODE=''
		where SPOT_CODE=#{spotCode}
	</delete>
	
	
	<select id="getProWorker" parameterType="map" resultType="map">
		select
		<include refid="Base_Column_List" />
		from pro_workers
		where SYS_PROCESS_FLAG='1'
		and  WORKER_CODE=#{workerCode}
	</select>
	

	<select id="queryForCount" parameterType="java.util.HashMap"
		resultType="int">
		SELECT
			count(1)
		FROM
			pro_workers b
		LEFT JOIN pro_spot c ON b.SPOT_CODE = c.SPOT_CODE
		AND c.SYS_PROCESS_FLAG = '1'
		LEFT JOIN pm_base d ON c.PRO_NO = d.PRO_NO
		WHERE
			b.SYS_PROCESS_FLAG = '1'
		<if test="proNo!=null and proNo!=''">
			and c.PRO_NO=#{proNo}
		</if>
		<if test="workerName!=null and workerName!=''">
			and b.WORKER_NAME like concat('%',#{workerName},'%')
		</if>
		
		
	</select>

	<select id="queryForPage" parameterType="java.util.HashMap"
		resultType="map">
		SELECT
		b.rowid,
		b.COMPANY_CODE companyCode,
		b.WORKER_CODE workerCode,
		b.WORKER_NAME workerName,
		b.GENDER gender,
		b.BIRTHDAY birthday,
		b.CARD_ID cardId,
		b.ADDRESS address,
		b.MOBILE mobile,
		b.PHOTO photo,
		b.PIC1 pic1,
		b.PIC2 pic2,
		b.PIC3 pic3,
		b.WORKER_CARD workerCard,
		b.WORKER_TYPE workType,
		b.STATUS
		status,
		b.SPOT_CODE spotCode,
		b.TEAMS teams,
		b.REMARK remark,
		c.SPOT_NAME spotName,
		d.PRO_NAME proName
		FROM
		pro_workers b
		LEFT JOIN pro_spot c ON b.SPOT_CODE = c.SPOT_CODE and c.SYS_PROCESS_FLAG = '1'
		LEFT JOIN pm_base d ON c.PRO_NO = d.PRO_NO
		WHERE
		b.SYS_PROCESS_FLAG = '1'
		
		<if test="proNo!=null and proNo!=''">
			and c.PRO_NO=#{proNo}
		</if>
		<if test="workerName!=null and workerName!=''">
			and b.WORKER_NAME like concat('%',#{workerName},'%')
		</if>
		
		limit #{firstResult},#{maxResult}
	</select>
	
	
	
	<select id="queryForCount1" parameterType="java.util.HashMap"
		resultType="int">
		select count(*)
		from pro_workers b
		where b.SYS_PROCESS_FLAG='1'
		AND (
			b.SPOT_CODE IS  NULL
			OR b.SPOT_CODE = ''
		)
		
	</select>

	<select id="queryForPage1" parameterType="java.util.HashMap"
		resultType="map">
		SELECT
		b.rowid,
		b.COMPANY_CODE companyCode,
		b.WORKER_CODE workerCode,
		b.WORKER_NAME workerName,
		b.GENDER gender,
		b.BIRTHDAY birthday,
		b.CARD_ID cardId,
		b.ADDRESS address,
		b.MOBILE mobile,
		b.PHOTO photo,
		b.PIC1 pic1,
		b.PIC2 pic2,
		b.PIC3 pic3,
		b.WORKER_CARD workerCard,
		b.STATUS
		status,
		b.SPOT_CODE spotCode,
		b.TEAMS teams,
		b.REMARK remark,
		c.SPOT_NAME spotName,
		b.WORKER_TYPE  workerType
		FROM
		pro_workers b
		LEFT JOIN pro_spot c ON b.SPOT_CODE = c.SPOT_CODE and c.SYS_PROCESS_FLAG = '1'
		WHERE
		b.SYS_PROCESS_FLAG = '1'
		AND (
			b.SPOT_CODE IS  NULL
			OR  b.SPOT_CODE = ''
		)
		limit #{firstResult},#{maxResult}
	</select>

	<select id="getSpotWorkers" parameterType="map" resultType="map">
	SELECT
		b.rowid,
		b.COMPANY_CODE companyCode,
		b.WORKER_CODE workerCode,
		b.WORKER_NAME workerName,
		b.GENDER gender,
		b.BIRTHDAY birthday,
		b.CARD_ID cardId,
		b.ADDRESS address,
		b.MOBILE mobile,
		b.PHOTO photo,
		b.PIC1 pic1,
		b.PIC2 pic2,
		b.PIC3 pic3,
		b.WORKER_CARD workerCard,
		b.STATUS status,
		b.SPOT_CODE spotCode,
		b.TEAMS teams,
		b.REMARK remark,
		b.WORKER_TYPE  workerType,
			CASE
	WHEN b.WORKER_TYPE = '1' THEN
		'项目经理'
	WHEN b.WORKER_TYPE = '2' THEN
		'施工员'
	WHEN b.WORKER_TYPE = '3' THEN
		'安全员'
	WHEN b.WORKER_TYPE = '4' THEN
		'质量员'
	WHEN b.WORKER_TYPE = '5' THEN
		'材料员'
	WHEN b.WORKER_TYPE = '6' THEN
		'焊工'
	WHEN b.WORKER_TYPE = '7' THEN
		'电工'
	WHEN b.WORKER_TYPE = '8' THEN
		'桩机'
	WHEN b.WORKER_TYPE = '9' THEN
		'辅助工'
	END workerTypeName
		FROM
		pro_workers b
		WHERE
		b.SYS_PROCESS_FLAG = '1'
		and b.SPOT_CODE=#{spotCode}
	</select>

	<insert id="insert" parameterType="com.glens.pwCloudOs.pm.scene.workers.vo.ProWorkers">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into pro_workers (rowid, COMPANY_CODE, WORKER_CODE,
		WORKER_NAME, GENDER, BIRTHDAY,
		CARD_ID, ADDRESS, MOBILE,
		PHOTO, PIC1, PIC2,
		PIC3, WORKER_CARD, STATUS,
		SPOT_CODE, TEAMS, WORKER_TYPE, 
      RECORD_STATUS,REMARK,
		SYS_CREATE_TIME, SYS_UPDATE_TIME, SYS_DELETE_TIME,
		SYS_PROCESS_FLAG)
		values (#{rowid,jdbcType=BIGINT}, #{companyCode,jdbcType=VARCHAR},
		#{workerCode,jdbcType=VARCHAR},
		#{workerName,jdbcType=VARCHAR}, #{gender,jdbcType=CHAR}, #{birthday,jdbcType=VARCHAR},
		#{cardId,jdbcType=VARCHAR}, #{address,jdbcType=VARCHAR},
		#{mobile,jdbcType=VARCHAR},
		#{photo,jdbcType=VARCHAR}, #{pic1,jdbcType=VARCHAR}, #{pic2,jdbcType=VARCHAR},
		#{pic3,jdbcType=VARCHAR}, #{workerCard,jdbcType=VARCHAR},
		#{status,jdbcType=CHAR},
		#{spotCode,jdbcType=VARCHAR}, #{teams,jdbcType=VARCHAR},#{workerType,jdbcType=CHAR}, 
      #{recordStatus,jdbcType=CHAR}, #{remark,jdbcType=VARCHAR},
		#{sysCreateTime,jdbcType=VARCHAR}, #{sysUpdateTime,jdbcType=VARCHAR},
		#{sysDeleteTime,jdbcType=VARCHAR},
		#{sysProcessFlag,jdbcType=CHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.glens.pwCloudOs.pm.scene.workers.vo.ProWorkers">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into pro_workers
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="rowid != null">
				rowid,
			</if>
			<if test="companyCode != null">
				COMPANY_CODE,
			</if>
			<if test="workerCode != null">
				WORKER_CODE,
			</if>
			<if test="workerName != null">
				WORKER_NAME,
			</if>
			<if test="gender != null">
				GENDER,
			</if>
			<if test="birthday != null">
				BIRTHDAY,
			</if>
			<if test="cardId != null">
				CARD_ID,
			</if>
			<if test="address != null">
				ADDRESS,
			</if>
			<if test="mobile != null">
				MOBILE,
			</if>
			<if test="photo != null">
				PHOTO,
			</if>
			<if test="pic1 != null">
				PIC1,
			</if>
			<if test="pic2 != null">
				PIC2,
			</if>
			<if test="pic3 != null">
				PIC3,
			</if>
			<if test="workerCard != null">
				WORKER_CARD,
			</if>
			<if test="status != null">
				STATUS,
			</if>
			<if test="spotCode != null">
				SPOT_CODE,
			</if>
			<if test="teams != null">
				TEAMS,
			</if>
			 <if test="workerType != null" >
		        WORKER_TYPE,
		      </if>
		      <if test="recordStatus != null" >
		        RECORD_STATUS,
		      </if>
			
			<if test="remark != null">
				REMARK,
			</if>
			<if test="sysCreateTime != null">
				SYS_CREATE_TIME,
			</if>
			<if test="sysUpdateTime != null">
				SYS_UPDATE_TIME,
			</if>
			<if test="sysDeleteTime != null">
				SYS_DELETE_TIME,
			</if>
			<if test="sysProcessFlag != null">
				SYS_PROCESS_FLAG,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="rowid != null">
				#{rowid,jdbcType=BIGINT},
			</if>
			<if test="companyCode != null">
				#{companyCode,jdbcType=VARCHAR},
			</if>
			<if test="workerCode != null">
				#{workerCode,jdbcType=VARCHAR},
			</if>
			<if test="workerName != null">
				#{workerName,jdbcType=VARCHAR},
			</if>
			<if test="gender != null">
				#{gender,jdbcType=CHAR},
			</if>
			<if test="birthday != null">
				#{birthday,jdbcType=VARCHAR},
			</if>
			<if test="cardId != null">
				#{cardId,jdbcType=VARCHAR},
			</if>
			<if test="address != null">
				#{address,jdbcType=VARCHAR},
			</if>
			<if test="mobile != null">
				#{mobile,jdbcType=VARCHAR},
			</if>
			<if test="photo != null">
				#{photo,jdbcType=VARCHAR},
			</if>
			<if test="pic1 != null">
				#{pic1,jdbcType=VARCHAR},
			</if>
			<if test="pic2 != null">
				#{pic2,jdbcType=VARCHAR},
			</if>
			<if test="pic3 != null">
				#{pic3,jdbcType=VARCHAR},
			</if>
			<if test="workerCard != null">
				#{workerCard,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				#{status,jdbcType=CHAR},
			</if>
			<if test="spotCode != null">
				#{spotCode,jdbcType=VARCHAR},
			</if>
			<if test="teams != null">
				#{teams,jdbcType=VARCHAR},
			</if>
			<if test="workerType != null" >
	        #{workerType,jdbcType=CHAR},
	      </if>
	      <if test="recordStatus != null" >
	        #{recordStatus,jdbcType=CHAR},
	      </if>
			<if test="remark != null">
				#{remark,jdbcType=VARCHAR},
			</if>
			<if test="sysCreateTime != null">
				#{sysCreateTime,jdbcType=VARCHAR},
			</if>
			<if test="sysUpdateTime != null">
				#{sysUpdateTime,jdbcType=VARCHAR},
			</if>
			<if test="sysDeleteTime != null">
				#{sysDeleteTime,jdbcType=VARCHAR},
			</if>
			<if test="sysProcessFlag != null">
				#{sysProcessFlag,jdbcType=CHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.glens.pwCloudOs.pm.scene.workers.vo.ProWorkers">
		
		update pro_workers
		<set>
			<if test="companyCode != null">
				COMPANY_CODE = #{companyCode,jdbcType=VARCHAR},
			</if>
			<if test="workerName != null">
				WORKER_NAME = #{workerName,jdbcType=VARCHAR},
			</if>
			<if test="gender != null">
				GENDER = #{gender,jdbcType=CHAR},
			</if>
			<if test="birthday != null">
				BIRTHDAY = #{birthday,jdbcType=VARCHAR},
			</if>
			<if test="cardId != null">
				CARD_ID = #{cardId,jdbcType=VARCHAR},
			</if>
			<if test="address != null">
				ADDRESS = #{address,jdbcType=VARCHAR},
			</if>
			<if test="mobile != null">
				MOBILE = #{mobile,jdbcType=VARCHAR},
			</if>
			<if test="photo != null">
				PHOTO = #{photo,jdbcType=VARCHAR},
			</if>
			<if test="pic1 != null">
				PIC1 = #{pic1,jdbcType=VARCHAR},
			</if>
			<if test="pic2 != null">
				PIC2 = #{pic2,jdbcType=VARCHAR},
			</if>
			<if test="pic3 != null">
				PIC3 = #{pic3,jdbcType=VARCHAR},
			</if>
			<if test="workerCard != null">
				WORKER_CARD = #{workerCard,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				STATUS = #{status,jdbcType=CHAR},
			</if>
			<if test="spotCode != null">
				SPOT_CODE = #{spotCode,jdbcType=VARCHAR},
			</if>
			<if test="teams != null">
				TEAMS = #{teams,jdbcType=VARCHAR},
			</if>
			<if test="workerType != null" >
	        WORKER_TYPE = #{workerType,jdbcType=CHAR},
	      	</if>
	      	<if test="recordStatus != null" >
	        RECORD_STATUS = #{recordStatus,jdbcType=CHAR},
	      	</if>
			<if test="remark != null">
				REMARK = #{remark,jdbcType=VARCHAR},
			</if>
			<if test="sysCreateTime != null">
				SYS_CREATE_TIME = #{sysCreateTime,jdbcType=VARCHAR},
			</if>
			<if test="sysUpdateTime != null">
				SYS_UPDATE_TIME = #{sysUpdateTime,jdbcType=VARCHAR},
			</if>
			<if test="sysDeleteTime != null">
				SYS_DELETE_TIME = #{sysDeleteTime,jdbcType=VARCHAR},
			</if>
			<if test="sysProcessFlag != null">
				SYS_PROCESS_FLAG = #{sysProcessFlag,jdbcType=CHAR},
			</if>
		</set>
		where WORKER_CODE = #{workerCode}
	</update>
	
	<update id="updateByPrimaryKey" parameterType="com.glens.pwCloudOs.pm.scene.workers.vo.ProWorkers">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update pro_workers
		set COMPANY_CODE = #{companyCode,jdbcType=VARCHAR},
		WORKER_NAME = #{workerName,jdbcType=VARCHAR},
		GENDER = #{gender,jdbcType=CHAR},
		BIRTHDAY = #{birthday,jdbcType=VARCHAR},
		CARD_ID = #{cardId,jdbcType=VARCHAR},
		ADDRESS = #{address,jdbcType=VARCHAR},
		MOBILE = #{mobile,jdbcType=VARCHAR},
		PHOTO = #{photo,jdbcType=VARCHAR},
		PIC1 = #{pic1,jdbcType=VARCHAR},
		PIC2 = #{pic2,jdbcType=VARCHAR},
		PIC3 = #{pic3,jdbcType=VARCHAR},
		WORKER_CARD = #{workerCard,jdbcType=VARCHAR},
		STATUS = #{status,jdbcType=CHAR},
		SPOT_CODE = #{spotCode,jdbcType=VARCHAR},
		TEAMS = #{teams,jdbcType=VARCHAR},
		 TEAMS = #{teams,jdbcType=VARCHAR},
      	WORKER_TYPE = #{workerType,jdbcType=CHAR},
		REMARK = #{remark,jdbcType=VARCHAR},
		SYS_CREATE_TIME = #{sysCreateTime,jdbcType=VARCHAR},
		SYS_UPDATE_TIME = #{sysUpdateTime,jdbcType=VARCHAR},
		SYS_DELETE_TIME = #{sysDeleteTime,jdbcType=VARCHAR},
		SYS_PROCESS_FLAG = #{sysProcessFlag,jdbcType=CHAR}
		where WORKER_CODE = #{workerCode}
	</update>
</mapper>