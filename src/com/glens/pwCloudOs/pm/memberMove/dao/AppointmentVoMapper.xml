<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.glens.pwCloudOs.pm.memberMove.dao.AppointmentVoMapper" >
 
 
  <select id="queryForCount" parameterType="java.util.HashMap" resultType="int">
  	select count(*) from  PM_EMPLOYEE_APPOINTMENT p
	left join md_employee m on p.EMPLOYEECODE=m.EMPLOYEECODE
	where 1=1
	<if test="employeeName != null and employeeName != ''">
	  and  m.EMPLOYEENAME like "%"#{employeeName}"%"
    </if>
	
	<if test="proNo != null and proNo!=''">
  		and p.PRO_NO=#{proNo}
  	</if>
  	<if test="fromDate != null and fromDate != ''">
	  	and p.APPOINTMENT_DATE &gt;= #{fromDate}
    </if>
	<if test="toDate != null and toDate != ''">
	  	and p.APPOINTMENT_DATE &lt;= #{toDate}
	</if>
  </select>
  
  <select id="queryForPage" parameterType="java.util.HashMap" resultType="map">
  	select p.*,m.EMPLOYEENAME from  PM_EMPLOYEE_APPOINTMENT p
	left join md_employee m on p.EMPLOYEECODE=m.EMPLOYEECODE
	where 1=1
	<if test="employeeName != null and employeeName != ''">
	  and  m.EMPLOYEENAME like "%"#{employeeName}"%"
    </if>
	
	<if test="proNo != null and proNo!=''">
  		and p.PRO_NO=#{proNo}
  	</if>
  	<if test="fromDate != null and fromDate != ''">
	  	and p.APPOINTMENT_DATE &gt;= #{fromDate}
    </if>
	<if test="toDate != null and toDate != ''">
	  	and p.APPOINTMENT_DATE &lt;= #{toDate}
	</if>
	order by p.ROW_ID desc
  	limit #{firstResult},#{maxResult}
	
  </select>
  
  
  <insert id="insert" parameterType="com.glens.pwCloudOs.pm.memberMove.vo.AppointmentVo" >
		insert into PM_EMPLOYEE_APPOINTMENT(COMPANY_CODE,EMPLOYEECODE,APPOINTMEN_CODE,FILE_NO,PRO_NO,
		PRO_NAME,APPOINTMENT_TYPE,APPOINTMENT_DATE,VALID_DATE,APPOINTMENT_YEAR,APPOINTMENT_MONTH,SYS_CREATE_TIME,SYS_PROCESS_FLAG)
		VALUES(#{companyCode},#{employeeCode},#{appointmentCode},#{fileNo},#{proNo},#{proName},#{appoinmentType},#{appoinmentDate},#{validDate},#{appoinmentYear},#{appoinmentMonth},now(),'1')
  </insert>
  
  
  <update id="updateManager" parameterType="map">
  	update pm_base set pro_manager=#{employeeName},employeecode=#{employeeCode}
	where pro_no=#{proNo}
  </update>
 
  
  
  
</mapper>