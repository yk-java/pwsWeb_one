<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.glens.pwCloudOs.pm.taskMgr.device.dao.PmDeviceProblemMapper">
  <resultMap id="BaseResultMap" type="com.glens.pwCloudOs.pm.taskMgr.device.vo.PmDeviceProblem">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="rowid" jdbcType="BIGINT" property="rowid" />
    <result column="COMPANY_CODE" jdbcType="VARCHAR" property="companyCode" />
    <result column="PRO_NO" jdbcType="VARCHAR" property="proNo" />
    <result column="PRO_NAME" jdbcType="VARCHAR" property="proName" />
    <result column="PROBLEM_CODE" jdbcType="VARCHAR" property="problemCode" />
    <result column="PROBLEM_NAME" jdbcType="VARCHAR" property="problemName" />
    <result column="PROBLEM_TYPE" jdbcType="INTEGER" property="problemType" />
    <result column="PARENT_PROBLEM_CODE" jdbcType="VARCHAR" property="parentProblemCode" />
    <result column="PARENT_PROBLEM_NAME" jdbcType="VARCHAR" property="parentProblemName" />
    <result column="SYS_CREATE_TIME" jdbcType="TIMESTAMP" property="sysCreateTime" />
    <result column="SYS_UPDATE_TIME" jdbcType="TIMESTAMP" property="sysUpdateTime" />
    <result column="SYS_DELETE_TIME" jdbcType="TIMESTAMP" property="sysDeleteTime" />
    <result column="SYS_PROCESS_FLAG" jdbcType="CHAR" property="sysProcessFlag" />
    <result column="REMARKS" jdbcType="VARCHAR" property="remarks" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    rowid, COMPANY_CODE, PRO_NO, PROBLEM_CODE, PROBLEM_NAME, PROBLEM_TYPE, PARENT_PROBLEM_CODE, 
    SYS_CREATE_TIME, SYS_UPDATE_TIME, SYS_DELETE_TIME, SYS_PROCESS_FLAG, REMARKS
  </sql>
  <select id="findById" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    	t1.*, t2.pro_name, t4.problem_name as PARENT_PROBLEM_NAME
    from pm_device_problem t1
    left join pm_base t2 on t2.pro_no = t1.pro_no
    left join pm_device_problem t4 on t4.problem_code = t1.parent_problem_code
    where t1.rowid = #{rowid,jdbcType=BIGINT}
  </select>
  
  <select id="findByProblemCode" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    	t1.*, t2.pro_name, t4.problem_name as PARENT_PROBLEM_NAME
    from pm_device_problem t1
    left join pm_base t2 on t2.pro_no = t1.pro_no
    left join pm_device_problem t4 on t4.problem_code = t1.parent_problem_code
    where t1.problem_code = #{problemCode,jdbcType=VARCHAR}
  </select>
  
  <delete id="delete" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from pm_device_problem
    where rowid = #{rowid,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.glens.pwCloudOs.pm.taskMgr.device.vo.PmDeviceProblem">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into pm_device_problem (rowid, COMPANY_CODE, PRO_NO, 
      PROBLEM_CODE, PROBLEM_NAME, PROBLEM_TYPE, 
      PARENT_PROBLEM_CODE, SYS_CREATE_TIME, SYS_UPDATE_TIME, 
      SYS_DELETE_TIME, SYS_PROCESS_FLAG, REMARKS
      )
    values (#{rowid,jdbcType=BIGINT}, #{companyCode,jdbcType=VARCHAR}, #{proNo,jdbcType=VARCHAR}, 
      #{problemCode,jdbcType=VARCHAR}, #{problemName,jdbcType=VARCHAR}, #{problemType,jdbcType=INTEGER}, 
      #{parentProblemCode,jdbcType=VARCHAR}, now(), null, 
      null, 1, #{remarks,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.glens.pwCloudOs.pm.taskMgr.device.vo.PmDeviceProblem">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into pm_device_problem
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="rowid != null">
        rowid,
      </if>
      <if test="companyCode != null">
        COMPANY_CODE,
      </if>
      <if test="proNo != null">
        PRO_NO,
      </if>
      <if test="problemCode != null">
        PROBLEM_CODE,
      </if>
      <if test="problemName != null">
        PROBLEM_NAME,
      </if>
      <if test="problemType != null">
        PROBLEM_TYPE,
      </if>
      <if test="parentProblemCode != null">
        PARENT_PROBLEM_CODE,
      </if>
      <if test="sysCreateTime != null">
        SYS_CREATE_TIME,
      </if>
      <if test="sysUpdateTime != null">
        SYS_UPDATE_TIME,
      </if>
      <if test="sysDeleteTime != null">
        SYS_DELETE_TIME,
      </if>
      <if test="sysProcessFlag != null">
        SYS_PROCESS_FLAG,
      </if>
      <if test="remarks != null">
        REMARKS,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="rowid != null">
        #{rowid,jdbcType=BIGINT},
      </if>
      <if test="companyCode != null">
        #{companyCode,jdbcType=VARCHAR},
      </if>
      <if test="proNo != null">
        #{proNo,jdbcType=VARCHAR},
      </if>
      <if test="problemCode != null">
        #{problemCode,jdbcType=VARCHAR},
      </if>
      <if test="problemName != null">
        #{problemName,jdbcType=VARCHAR},
      </if>
      <if test="problemType != null">
        #{problemType,jdbcType=INTEGER},
      </if>
      <if test="parentProblemCode != null">
        #{parentProblemCode,jdbcType=VARCHAR},
      </if>
      <if test="sysCreateTime != null">
        #{sysCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="sysUpdateTime != null">
        #{sysUpdateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="sysDeleteTime != null">
        #{sysDeleteTime,jdbcType=TIMESTAMP},
      </if>
      <if test="sysProcessFlag != null">
        #{sysProcessFlag,jdbcType=CHAR},
      </if>
      <if test="remarks != null">
        #{remarks,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="update" parameterType="com.glens.pwCloudOs.pm.taskMgr.device.vo.PmDeviceProblem">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update pm_device_problem
    <set>
      <if test="companyCode != null">
        COMPANY_CODE = #{companyCode,jdbcType=VARCHAR},
      </if>
      <if test="proNo != null">
        PRO_NO = #{proNo,jdbcType=VARCHAR},
      </if>
      <if test="problemCode != null">
        PROBLEM_CODE = #{problemCode,jdbcType=VARCHAR},
      </if>
      <if test="problemName != null">
        PROBLEM_NAME = #{problemName,jdbcType=VARCHAR},
      </if>
      <if test="problemType != null">
        PROBLEM_TYPE = #{problemType,jdbcType=INTEGER},
      </if>
      <if test="parentProblemCode != null">
        PARENT_PROBLEM_CODE = #{parentProblemCode,jdbcType=VARCHAR},
      </if>
      
        SYS_UPDATE_TIME = now(),
      <if test="sysDeleteTime != null">
        SYS_DELETE_TIME = #{sysDeleteTime,jdbcType=TIMESTAMP},
      </if>
      <if test="sysProcessFlag != null">
        SYS_PROCESS_FLAG = #{sysProcessFlag,jdbcType=CHAR},
      </if>
      <if test="remarks != null">
        REMARKS = #{remarks,jdbcType=VARCHAR},
      </if>
    </set>
    where rowid = #{rowid,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.glens.pwCloudOs.pm.taskMgr.device.vo.PmDeviceProblem">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update pm_device_problem
    set COMPANY_CODE = #{companyCode,jdbcType=VARCHAR},
      PRO_NO = #{proNo,jdbcType=VARCHAR},
      PROBLEM_CODE = #{problemCode,jdbcType=VARCHAR},
      PROBLEM_NAME = #{problemName,jdbcType=VARCHAR},
      PROBLEM_TYPE = #{problemType,jdbcType=INTEGER},
      PARENT_PROBLEM_CODE = #{parentProblemCode,jdbcType=VARCHAR},
      SYS_CREATE_TIME = #{sysCreateTime,jdbcType=TIMESTAMP},
      SYS_UPDATE_TIME = #{sysUpdateTime,jdbcType=TIMESTAMP},
      SYS_DELETE_TIME = #{sysDeleteTime,jdbcType=TIMESTAMP},
      SYS_PROCESS_FLAG = #{sysProcessFlag,jdbcType=CHAR},
      REMARKS = #{remarks,jdbcType=VARCHAR}
    where rowid = #{rowid,jdbcType=BIGINT}
  </update>
  
  
  <select id="queryForList" parameterType="map" resultMap="BaseResultMap">
  select
  	t1.*, t2.problem_name as parent_problem_name
  from pm_device_problem t1
  left join pm_device_problem t2 on t2.problem_code = t1.parent_problem_code
  where 1=1
  and t1.pro_no = #{proNo}
  <if test="parentProblemCode != null and parentProblemCode != ''">
  and t1.parent_problem_code = #{parentProblemCode}
  </if>
  </select>
  
</mapper>