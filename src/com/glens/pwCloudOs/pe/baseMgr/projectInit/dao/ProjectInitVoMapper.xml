<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.glens.pwCloudOs.pe.baseMgr.projectInit.dao.ProjectInitVoMapper" >
  <resultMap id="BaseResultMap" type="com.glens.pwCloudOs.pe.baseMgr.projectInit.vo.ProjectInitVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="rowid" property="rowid" jdbcType="BIGINT" />
    <result column="COMPANY_CODE" property="companyCode" jdbcType="VARCHAR" />
    <result column="MCT_VIEW_NAME" property="mctViewName" jdbcType="VARCHAR" />
    <result column="MCT_VIEW_CODE" property="mctViewCode" jdbcType="VARCHAR" />
    <result column="PRO_NOS" property="proNos" jdbcType="REAL" />
    <result column="PRO_NAMES" property="proNames" jdbcType="VARCHAR" />
    <result column="PRO_MCT_CODES" property="proMctCodes" jdbcType="VARCHAR" />
    <result column="REMARKS" property="remarks" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
  COMPANY_CODE,MCT_VIEW_NAME,MCT_VIEW_CODE,PRO_NOS,PRO_NAMES,REMARKS,PRO_MCT_CODES
  </sql>
  
  <select id="queryForCount" parameterType="java.util.HashMap" resultType="int">
  	select count(*)
  	from PM_MCT_VIEW 
  	where COMPANY_CODE=#{companyCode} AND  SYS_PROCESS_FLAG='1'
  	<if test="mctViewName != null and mctViewName != ''">
    and MCT_VIEW_NAME like "%"#{mctViewName}"%"
    </if>
  </select>
  
  <select id="queryForPage" parameterType="java.util.HashMap" resultMap="BaseResultMap">
  	select 
    <include refid="Base_Column_List" />
    from PM_MCT_VIEW 
  	where COMPANY_CODE=#{companyCode} AND  SYS_PROCESS_FLAG='1'
  	<if test="mctViewName != null and mctViewName != ''">
    and MCT_VIEW_NAME like "%"#{mctViewName}"%"
    </if>
  	limit #{firstResult},#{maxResult}
  </select>
  
  <select id="findById" resultMap="BaseResultMap" parameterType="com.glens.pwCloudOs.pe.baseMgr.projectInit.vo.ProjectInitVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
   from PM_MCT_VIEW 
  	where COMPANY_CODE=#{companyCode} AND  SYS_PROCESS_FLAG='1'
    and  MCT_VIEW_CODE = #{mctViewCode}
  </select>
  <delete id="delete" parameterType="com.glens.pwCloudOs.pe.baseMgr.projectInit.vo.ProjectInitVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from PM_MCT_VIEW
    where MCT_VIEW_CODE = #{mctViewCode}
  </delete>
  <insert id="insert" parameterType="com.glens.pwCloudOs.pe.baseMgr.materialType.vo.MaterialTypeVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    INSERT INTO PM_MCT_VIEW(COMPANY_CODE,MCT_VIEW_NAME,MCT_VIEW_CODE,PRO_NOS,PRO_NAMES,PRO_MCT_CODES,PRO_MCT_NAMES,DEVICE_TYPE_CODE,SYS_CREATE_TIME,SYS_PROCESS_FLAG,REMARKS)
    VALUES(#{companyCode},#{mctViewName},#{mctViewCode},#{proNos},#{proNames},#{proMctCodes},#{proMctNames},#{deviceTypeCode},now(),'1',#{remarks})

  </insert>
  
  <update id="update" parameterType="com.glens.pwCloudOs.pe.baseMgr.materialType.vo.MaterialTypeVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update PM_MCT_VIEW
    <set >
      <if test="mctViewName != null" >
        MCT_VIEW_NAME = #{mctViewName,jdbcType=VARCHAR},
      </if>
      <if test="proNos != null and proNos !=''">
      PRO_NOS = #{proNos},
      </if>
      <if test="proNames != null" >
        PRO_NAMES = #{proNames},
      </if>
      
      
      <if test="proMctCodes != null" >
        PRO_MCT_CODES = #{proMctCodes},
      </if>
      
      <if test="proMctNames != null" >
        PRO_MCT_NAMES = #{proMctNames},
      </if>
      
        <if test="deviceTypeCode != null" >
        DEVICE_TYPE_CODE = #{deviceTypeCode},
      </if>
      
      <if test="remarks != null" >
        REMARKS = #{remarks,jdbcType=VARCHAR},
      </if>
      SYS_UPDATE_TIME = now()
    </set>
    where MCT_VIEW_CODE = #{mctViewCode}
  </update>
  
  <select id="getPmMct" resultType="map" parameterType="map">
  
	select PRO_NO,MCT_CODE mctcode,MCT_NAME mctname,DEVICE_TYPE_CODE decivetypecode from PM_MCT
	where COMPANY_CODE=#{companyCode}  AND PRO_NO=#{proNo}
	
	
  </select>
  
  
  <select id="treeList" parameterType="map" resultType="map">
  		select c.CATEGORY_CODE categoryCode,c.CATEGORY_NAME categoryName,p.pro_no proNo,p.pro_name proName,
		m.MCT_CODE mctCode,m.MCT_NAME mctName,m.DEVICE_TYPE_CODE deviceType from pm_base p
		join pm_category  c on c.CATEGORY_CODE=p.CATEGORY_CODE
		join  pm_mct m on m.PRO_NO=p.PRO_NO
		where p.company_code=#{companyCode}
		group by c.CATEGORY_CODE
		order by c.CATEGORY_CODE,p.pro_no
  </select>
  
   <select id="treeList1" parameterType="map" resultType="map">
  		select c.CATEGORY_CODE categoryCode,c.CATEGORY_NAME categoryName,p.pro_no proNo,p.pro_name proName,
		m.MCT_CODE mctCode,m.MCT_NAME mctName,m.DEVICE_TYPE_CODE deviceType from pm_base p
		join pm_category  c on c.CATEGORY_CODE=p.CATEGORY_CODE
		join  pm_mct m on m.PRO_NO=p.PRO_NO
		where p.company_code=#{companyCode} and c.CATEGORY_CODE=#{categoryCode}
		group by p.pro_no
		order by c.CATEGORY_CODE,p.pro_no
  </select>
  
  <select id="treeList2" parameterType="map" resultType="map">
  		select c.CATEGORY_CODE categoryCode,c.CATEGORY_NAME categoryName,p.pro_no proNo,p.pro_name proName,
		m.MCT_CODE mctCode,m.MCT_NAME mctName,m.DEVICE_TYPE_CODE deviceType from pm_base p
		join pm_category  c on c.CATEGORY_CODE=p.CATEGORY_CODE
		join  pm_mct m on m.PRO_NO=p.PRO_NO
		where p.company_code=#{companyCode} and c.CATEGORY_CODE=#{categoryCode} and p.pro_no=#{proNo}
		order by c.CATEGORY_CODE,p.pro_no
  </select>
  
  
</mapper>