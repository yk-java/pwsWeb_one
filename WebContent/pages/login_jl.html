<!DOCTYPE HTML>
<html>
<head>
<title> 登录 - 电网智能运维管控云服务平台 </title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

<link rel="shortcut icon" href="../favicon2.png" type="image/x-icon" />
<!-- <link rel="icon" sizes="any" mask href="../favicon.svg"> -->

<link rel="stylesheet" type="text/css" href="../bootstrap-3.3.5-dist/css/bootstrap.min.css"/>
<script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../js/placeholder.js"></script>
<script type="text/javascript" src="../js/jquery.cookie.js"></script>
<script type="text/javascript" src="../js/config.js"></script>
<script type="text/javascript" src="../js/respond.min.js"></script>
<style type="text/css">
body{font-family:微软雅黑;}
.logo{margin:10px 0;}
.content{background:url(../img/login/background_pic_jl.png)  no-repeat center;min-height:493px;margin:0 0;}
.bottom{text-align:center;margin:0 0;font-size:12px;color:#888;}

.dialog{width:316px;height:328px;background:#D9EBFF;margin:30px 0 0 0;}
.dialog_title{text-align:center;color:#1a1a1a;font-size:22px;margin:25px 0px;}
.dialog_content{margin:0 20px;}
.dialog_bottom{text-align:center;color:#fff;font-size:12px;}
.error_msg{color:#ff9900;font-size:12px;}
.txt1{background:#D9ebff;border:solid 1px #50A4FF;}
.btn1{background:#016DE3;}
.btn1:hover{background:#248AFA;}
</style>
</head>

<body>
	
	<div class="container">
		<div class="row logo">
			<img src="../img/login/logo_jl.png">
		</div>
	</div>
	<div class="content">
		<div class="container">
			<div  class="row">
				<div class="col-sm-8"></div>
				<div class="col-sm-4 dialog">
		<!-- 			<form action="main.html" method="post"> -->
						<div class="dialog_title">
							—— 欢迎登录 ——
						</div>
						<div class="dialog_content">
							<div class="form-group">
								<input type="text" name="uname" class="form-control txt1" placeholder="请输入用户名" maxlength="30">
							</div>
							<div class="form-group">
								<input type="password" name="upass" class="form-control txt1" placeholder="请输入登录密码" maxlength="30">
							</div>
							<div class="form-group">
								<button class="btn btn-primary btn-block btn1" onclick="doLogin()">登 录</button>
							</div>
							<div class="form-group">
								<span class="error_msg"></span>
							</div>
						</div>
						<div class="dialog_bottom">
						</div>
		<!-- 			</form> -->
				</div>
			</div>
		</div>
	</div>
	<div class="row bottom">
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>&nbsp;</p>
		<p>Copyright &copy; 2016-2018 Pwcloud.com. All Rights Reserved. 量为石电网智能运维管控云服务平台 版权所有</p>
		<p><img src="../img/wj.png" style="vertical-align:middle;"/> 苏公网安备 11010802010000 &nbsp;&nbsp; 苏ICP备11010000号&nbsp;&nbsp;苏ICP证150000<a href="../js/jquery-1.9.1.min.js" target="_blank">号</a></p>
	</div>
	<script type="text/javascript">
		window.onkeyup=function(e){
			if(e.keyCode==13){
				doLogin();
			}
		};
		function doLogin(){
			var $uname = $("input[name=uname]");
			var $upass = $("input[name=upass]");
			
			var $error_msg = $(".error_msg");
			var icon = "<span class=\"glyphicon glyphicon-exclamation-sign\"></span> ";
			// check
			if(!$uname.val() || $uname.val().length==0){
				var msg="请输入用户名！";
				$error_msg.html(icon+msg);
				$uname.focus();
				return false;
			}
			if(!$upass.val() || $upass.val().length==0){
				var msg="请输入密码！";
				$error_msg.html(icon+msg);
				$upass.focus();
				return false;
			}
			// login
			$.ajax({
				url:serviceBasePath+"eap/pmsServices/loginService",
				method:"GET",
				data:{"userName":$uname.val(),"psw":$upass.val()},
				cache:false,
				success:function(res){
					if(!res){
						msg="服务器无响应信息！";
						$error_msg.html(icon+msg);
						return;
					}
					if(res.statusCode=="200"){
						// 200
						var ticket = res.ticket;
						$.cookie("pmsWeb_ticket", ticket);
						res.data.ticket=ticket;
						$.cookie("pmsWeb_user_data", JSON.stringify(res.data));
						location.href="main.html?ticket="+ticket;
					}else{
						msg="用户名或密码错误！";
						$error_msg.html(icon+msg);
					}
				},
				error:function(){
					var msg = "服务器访问失败";
					$error_msg.html(icon+msg);
				}
			});
		}
	</script>
</body>
</html>
