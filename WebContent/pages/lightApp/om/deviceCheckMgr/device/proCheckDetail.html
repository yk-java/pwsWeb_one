<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title> 设备管理 </title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	<script src="../../../js/jquery-1.9.1.min.js"></script>
	<link rel="stylesheet" type="text/css" href="../../../css/bxyw2.css"/>
	<script type="text/javascript" src="../../../js/jquery.cookie.js"></script>
	<script type="text/javascript" src="../../../js/angular.min.js"></script>
	<script type="text/javascript" src="../../../js/DropDownList-1.2/DropDownList-v1.2.js"></script>
	<link rel="stylesheet" type="text/css" href="../../../js/DropDownList-1.2/DropDownList.css"/>
	<script type="text/javascript" src="../../../js/config.js"></script>
	<script type="text/javascript" src="../../../js/util.js"></script>
	<script type="text/javascript" src="../../../js/ng-base.js"></script>
	<script type="text/javascript" src="../../../js/ViewState.js"></script>
	<script type="text/javascript" src="../../../js/eapJs/core/eap.core.js" ></script>
	<script type="text/javascript" src="../../../js/eapJs/plugins/eap.tip.js" ></script>
	<script type="text/javascript" src="../../../js/eapJs/plugins/eap.validate.js"></script>
	<script type="text/javascript" src="../../../js/eapJs/local/eap.lang-zh_CN.js"></script>
	<link rel="stylesheet" type="text/css" href="../../../css/validate.css"/>
	<link rel="stylesheet" type="text/css" href="../../../css/edit.css"/>
	
	<script type="text/javascript" src="../../../js/showDlog/showDlog.js"></script>
	<link rel="stylesheet" type="text/css" href="../../../js/showDlog/showDlog-blue.css" />
</head>
<body id="checkDetail" ng-app="userMgr" ng-controller="userMgrCtrl" style="height: initial;">
	<header>
		<div class="return"><img src="../../../img/return.png"/></div>
		{{datalist1.checkTime}}
	</header>
	<section>
		<ul class="checkList">
			<li class="bcfff">
				<span>●</span>检查结果：
				<label ng-if="datalist1.checkResult==1">合格</label>
				<label ng-if="datalist1.checkResult==2" class="ungood">不合格</label>
			</li>
			<li class="curtip">
				<span>●</span><span class="tip_title">审核类型</span>
				<p ng-if="datalist1.checkType==1">项目自检</p>
				<p ng-if="datalist1.checkType==2">质量专检</p>
			</li>
			<li class="curtip">
				<span>●</span><span class="tip_title">问题分类</span>
				<p>{{datalist1.faultName}}</p>
			</li>
			<li class="curtip">
				<span>●</span><span class="tip_title">描述</span>
				<p>{{datalist1.faultDescr}}</p>
			</li>
			<li class="curtip">
				<span>●</span><span class="tip_title">是否已整改</span>
				<p>
					<label ng-if="datalist1.isRectify==1">未整改</label>
					<label ng-if="datalist1.isRectify==2">已整改</label>
				</p>
			</li>
			<li>
				<span style="margin-right:10px">●</span><span class="tip_title">图片预览</span>
				<p style="margin-top:10px">
					<span ng-repeat="img in imgList track by $index" style="margin:0 3% 10px 0;display: inline-block;width:30%;position:relative">
					<span style="position:absolute;padding:5px 10px;background:black;opacity: 0.5;color:#fff" ng-click="showlgImg(img)">放大</span>
					<img src="{{img}}" onerror="javascript:this.src='../../../img/defaultImg02.png';" width="100%"/></span>
				</p>
			</li>
			<li class="curtip">
				<span>●</span><span class="tip_title">审核人</span>
				<p>{{datalist1.checkUserName}}</p>
			</li>
		</ul>
	</section>
	<div id="lgImgbox" style="position:fixed;top:0;left:0;right:0;bottom:0;height:100%;z-index:100;background:rgba(0,0,0,1) none repeat scroll !important;;display:none">
		<div style="float:right;color:#fff;font-size:24px;margin:10px 20px 0 0" ng-click="closelgImg()">ｘ</div>
		<div style="width:90%;margin:100px auto 0;">
			<img src="" width="100%" id="lgImg" onerror="javascript:this.src='../../../img/defaultImg02.png';"/>
		</div>
	</div>
	<script type="text/javascript">
	simpleController({
		moduleName:"userMgr",
		controllerName:"userMgrCtrl",
		init:function($scope, $http){
			/* init */
			ngScope = $scope;
			var userDataStr = $.cookie("pmsWeb_user_data");
			if(!userDataStr){
				location.href="../../../pages/login.html";
				return;
			}
			var userData = jQuery.parseJSON(userDataStr);
			//$scope.roleCode = userData.roleCode;
			var companyCode = userData.companyCode;
			ticket = $.cookie("pmsWeb_ticket");
			var params = getUrlParams();
			var rowid=params.rowid;
			$scope.imgList=[];
			$scope.imgList1=[];
			
			/* 数据加载 */
			$http.get(serviceBasePath+"eap/pmsServices/om/deviceMgr/qualityCheck/get?rowid="+rowid).success(function(res){
				if(res.statusCode==200){
					$scope.datalist1 = res.data;
					if($scope.datalist1.pics){
						$scope.datalist1.pics.split(",");
						$scope.imgList1=$scope.datalist1.pics.split(",");
						for(var i=0;i<$scope.imgList1.length;i++){
							var st=filePath+"?fileCode="+$scope.imgList1[i]+"&attachment=0"	
							$scope.imgList.push(st);
						}
					}
				}else if(res.statusCode==401){
					window.parent.location.href="../../../pages/login.html";
				}else if(res.statusCode==404){
					$scope.datalist1=[];
				}
			});
			$scope.showlgImg=function(url){
				$("#lgImgbox").show();
				$("#lgImg").attr("src",url)
			};
			$scope.closelgImg=function(){
				$("#lgImgbox").hide();
			};
			
		}
	});
		$(".return").click(function(){
			top.viewBack();
		})
	
	</script>
</body>
</html>