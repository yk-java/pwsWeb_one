<!DOCTYPE HTML>
<html>
<head>
<title> 类型管理</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<script type="text/javascript" src="../../../js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../../../js/jquery.cookie.js"></script>

<script type="text/javascript" src="../../../angular-1.4.6/angular.min.js"></script>
<script type="text/javascript" src="../../../js/util.js"></script>
<script type="text/javascript" src="../../../js/config.js"></script>
<script type="text/javascript" src="../../../js/ng-base.js"></script>
<link rel="stylesheet" type="text/css" href="../../../css/validate.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/edit.css"/>

<script type="text/javascript" src="../../../js/showDlog/showDlog.js"></script>
<link rel="stylesheet" type="text/css" href="../../../js/showDlog/showDlog-blue.css" />

<style type="text/css">
	.all{width:100%;height:100%}
	.top{height:18%;width:100%;background:#328BFF;color:#fff;font-family: '微软雅黑'}
	.tj{width:40%;float:left;height:20px;margin-top:12px;margin-left:30px;}
	.tj b{color:yellow}
	
	
	 .cnt
        {
            border-collapse: collapse;
            border: none;
           width:100%;
           line-height:35px;
           text-align: center;
        }
      .cnt  td
        {
            border: solid #ccc 1px;
        }
        .tr1{color:#999}
        tr.tab_header td{background:#328BFF;color:#fff;font-family: '微软雅黑';border:solid 1px #52ABFF;}
</style>

</head>

<body ng-app="projectType" ng-controller="userMgrCtrl">

<div class="all">
<!-- 	<div class="top"> -->
<!-- 		<div class="tj">表箱数量 : <b>1500</b></div> -->
<!-- 		<div class="tj">户&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数 : <b>1500</b></div> -->
<!-- 		<div class="tj">小&nbsp;区&nbsp;数&nbsp; : <b>1500</b></div> -->
<!-- 		<div class="tj">审核状态 : <b>已审核</b></div> -->
<!-- 	</div> -->
<!-- 	<table class="cnt"> -->
<!-- 		<tr style="height:50px;"> -->
<!-- 			<td>材料</td> -->
<!-- 			<td>勘测数量</td> -->
<!-- 			<td>审核数量</td> -->
<!-- 			<td>小区数</td> -->
<!-- 		</tr> -->
		
<!-- 		<tr class="tr1"  ng-repeat="item in huizongList"> -->
<!-- 			<td>{{item.name}}</td> -->
<!-- 			<td>{{item.num}}</td> -->
<!-- 			<td>{{item.num1}}</td> -->
<!-- 			<td>{{item.num2}}</td>	 -->
<!-- 		</tr> -->
<!-- 		<tr style="height:40px;"> -->
<!-- 			<td colspan="2">预算费用 : <b style="color:#328BFF">1500</b></td> -->
<!-- 			<td colspan="2">实际费用 : <b style="color:#328BFF">1500</b></td> -->
			
<!-- 		</tr> -->
<!-- 	</table> -->
	
	<table class="cnt">
		<tr class="tab_header">
			<td>改造单位</td>
			<td>表箱数量</td>
			<td>户数</td>
<!-- 			<td>小区数</td> -->
<!-- 			<td>单元数</td> -->
			<td ng-repeat="item in materialAttrs">{{item.cname}}</td>
			
		</tr>
		<tr ng-repeat="item in dataList">
			<td>{{item.reseverOrgname}}</td>
			
			<td>{{item.meterBoxCount}}</td>
			
			<td>{{item.houseHold}}</td>
<!-- 			<td>{{item.estateCount}}</td> -->
<!-- 			<td>{{item.unitCount}}</td> -->
			
			<td ng-repeat="item2 in materialAttrs">{{decim(item[item2.ename], 2)}}</td>
			
		</tr>
	</table>
	
</div>

<script type="text/javascript">
simpleController({			
	moduleName:"projectType",			
	controllerName:"userMgrCtrl",		
	init:function($scope, $http){
		/* init */
		$scope.dataList=[];
		$scope.materialAttrs=[];
		var urlParams = getUrlParams();
		var waittingDlog = new ShowDlog();
		waittingDlog.prompt({
			icon:"waitting",
			msg:"正在查询...",
			done:function(){},
			t:60*1000
		});
		
		/* 加载属性信息 */
		$scope.loadAttrs=function(deviceTypeCode){
			$scope.httpGet({
				url:"eap/pmsServices/om/deviceMgr/device/mctAttr?companyCode="+$scope.userData.companyCode,
				data:{"deviceTypeCode":deviceTypeCode},
				success:function(response){
					$scope.materialAttrs = $scope.filter(response.list);
				}
			});
		};
		$scope.loadAttrs(urlParams.deviceTypeCode);
		$scope.filter=function(data){
			var arr=[];
			for(var key in data){
				var item = data[key];
				if(item.dimPeBsMaterial==1){
					arr.push(item);
				}
			}
			return arr;
		};
		/* 加载数据 */
		$scope.httpGet({
			url:"eap/pmsServices/pe/baseMgr/remouldBatch/remouldStatistics?companyCode="+$scope.userData.companyCode+"&reserveProNo="+urlParams.reserveProNo+"&mctViewCode="+urlParams.mctViewCode+"&remouldBatchCode="+urlParams.remouldBatchCode,
			success:function(response){
				waittingDlog.close();
				$scope.dataList=response.list;
			}
		});
		
		$scope.decim=function(num, len){
			return decim(num, len);
		};
		$scope.getKeys=function(obj){
			var keys=[];
			for(k in obj){
				keys.push(k);
			}
			return keys;
		};
	}
});
	</script>
</body>
</html>
