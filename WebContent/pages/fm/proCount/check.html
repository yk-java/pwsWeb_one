<!DOCTYPE HTML>
<html>
<head>
<title>质量问题管理</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<script type="text/javascript" src="../../../js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../../../js/jquery.cookie.js"></script>
<script type="text/javascript"
	src="../../../bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>
</head>
<script type="text/javascript"
	src="../../../angular-1.4.6/angular.min.js"></script>
<script type="text/javascript" src="../../../js/PageBar.js"></script>
<script type="text/javascript"
	src="../../../js/DropDownList-1.2/DropDownList-v1.2.js"></script>
<link rel="stylesheet" type="text/css"
	href="../../../js/DropDownList-1.2/DropDownList.css" />
<script type="text/javascript" src="../../../js/Calendar.js"></script>
<script type="text/javascript" src="../../../js/config.js"></script>
<script type="text/javascript" src="../../../js/util.js"></script>
<script type="text/javascript" src="../../../js/ng-base.js"></script>

<script type="text/javascript" src="../../../js/eapJs/core/eap.core.js"></script>
<script type="text/javascript"
	src="../../../js/eapJs/plugins/eap.tip.js"></script>
<script type="text/javascript"
	src="../../../js/eapJs/plugins/eap.validate.js"></script>
<script type="text/javascript"
	src="../../../js/eapJs/local/eap.lang-zh_CN.js"></script>
<link rel="stylesheet" type="text/css" href="../../../css/validate.css" />
<link rel="stylesheet" type="text/css" href="../../../css/edit.css" />

<script type="text/javascript" src="../../../js/showDlog/showDlog.js"></script>
<link rel="stylesheet" type="text/css"
	href="../../../js/showDlog/showDlog-blue.css" />

<style type="text/css">
body {
	overflow: hidden;
}

.form_bottom {
	float: right;
}

.form_bottom .title_save {
	float: right;
}

.form_bottom .title_cancel {
	float: right;
}

.select_warp span {
	padding: 8px 10px;
	cursor: pointer
}

.select_warp span.cur {
	border-bottom: 2px solid #0078D7
}
</style>
</head>

<body ng-app="moduleName" ng-controller="controllerName">

	<div class="list">
		<div class="list_content">
			
			<div class="formWarp">
				<form id="saveForm" class="required-validate">
					<div class="form_div" style="font-size:14px" id="lay1">对“{{proNo}}”项目概算审核</div>
								<input type="hidden" name="proNo"/>
								<input type="hidden" name="budgetEstimateCode"/>
								<input type="hidden" name="versionCode"/>
								<input type="hidden" name="companyCode"/>
								
					<div style="width:100%;margin-left:5px;">
						&nbsp;<textarea rows="5" cols="60" placeholder="请输入审核意见" name="checkDesc" id="checkDesc"></textarea>
					</div>	
							
					<div class="form_bottom" style="width: 100%; float: right;margin-top:5px;">
							<a href="javascript:" ng-click="onSave()" class="title_save">
								&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过 </a> 
							<a href="javascript:" ng-click="unCheck()" class="title_save">
								&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;不通过 </a> 
							<a href="javascript:" ng-click="onCancel()" class="title_cancel">
								&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;取消 
							</a>
					</div>
					
				</form>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		var salaryLevel = "";
		var salaryGrade = "";
		simpleController({
			init : function($scope, $http) {
				$scope.valObj = {};

				// 参数
				var urlParams = getUrlParams();
				var userDataStr = $.cookie("pmsWeb_user_data");
				if (!userDataStr) {
					window.noLogin(location.href);
					return;
				}
				var userData = jQuery.parseJSON(userDataStr);
				var ticket = $scope.ticket;
				
				
				$scope.proNo=urlParams.proNo;
				
				//+"&budgetEstimateCode="+budgetestimateCode+"&versionCode="+versionCode


				/* 表单验证 */
				validator = $("#saveForm").validate({
					onsubmit : false,
					focusInvalid : false,
					focusCleanup : true,
					errorElement : "span",
					ignore : ".ignore",
					invalidHandler : function(form, validator) {
						var errors = validator.numberOfInvalids();
						if (errors) {

						}
					}
				});
				validator = $("#saveForm1").validate({
					onsubmit : false,
					focusInvalid : false,
					focusCleanup : true,
					errorElement : "span",
					ignore : ".ignore",
					invalidHandler : function(form, validator) {
						var errors = validator.numberOfInvalids();
						if (errors) {

						}
					}
				});

				$("input[name='proNo']").val(urlParams.proNo);

				$("input[name='budgetEstimateCode']").val(urlParams.budgetEstimateCode);
				$("input[name='versionCode']").val(urlParams.versionCode);
				
				$("input[name='companyCode']").val(userData.companyCode);
				$scope.onSave = function() {
					var message=$("#checkDesc").val();
					var returnval={};
					returnval.message=message;
					returnval.ispass="SUCCESS";
					parent.$dlog.data = returnval;
					parent.$dlog.close();
					
				};
				
				$scope.unCheck=function(){
					var message=$("#checkDesc").val();
					var returnval={};
					returnval.message=message;
					returnval.ispass="FALSE";
					
					parent.$dlog.data = returnval;
					parent.$dlog.close();
					
				};
				
				$scope.onCancel = function() {
					parent.$dlog.close();
				};
			}
		});
		$(".select_warp span").click(function() {
			$(this).addClass("cur").siblings().removeClass("cur");
			var n = $(this).index();
			$(".formWarp form").eq(n).show().siblings().hide();
		})
	</script>
</body>
</html>
