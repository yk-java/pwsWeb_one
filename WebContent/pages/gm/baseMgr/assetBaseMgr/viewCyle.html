<!DOCTYPE HTML>
<html>
<head>
<title> 类型管理</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<script type="text/javascript" src="../../../../js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../../../../js/jquery.cookie.js"></script>

<script type="text/javascript" src="../../../../angular-1.4.6/angular.min.js"></script>
<script type="text/javascript" src="../../../../js/util.js"></script>
<script type="text/javascript" src="../../../../js/config.js"></script>

<link rel="stylesheet" type="text/css" href="../../../../css/validate.css"/>
<link rel="stylesheet" type="text/css" href="../../../../css/edit.css"/>

<script type="text/javascript" src="../../../../js/showDlog/showDlog.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../js/showDlog/showDlog-blue.css" />

<style type="text/css">
	.all{width:120%;height:100%;}
	.div1{height:125%;float:left;width:250px;background:#E5F0FF}
	.div1 .div1_top{text-align:center;margin-top:2px;width:250px;height:170px;background-image: url("../../../../img/asset/background.png");background-repeat:no-repeat;  }
	.div1_top img{width:150px;height:80px;margin-top:45px;}
	.div2{height:125%;float:left;width:25%;background:#F2F2F2;border-right: 1px #eee solid}
	.div3{height:125%;float:left;width:25%;border-right: 1px #eee solid;background:#F2F2F2}
	.div4{height:125%;float:left;width:25%;background:#F2F2F2}
	
	.bg1{height:2px;width:100%; background-image: url("../../../../img/asset/background line_01.png"); background-repeat: repeat-x;}
	.bg2{height:2px;width:100%; background-image: url("../../../../img/asset/background line_02.png"); background-repeat: repeat-x;}
	.table1{width:90%;line-height:24px;margin-left:2%}
	.font1{font-weight:700;width:50%;}
	.font2{color:#666}
	.div2_title{text-align:center;font-size:15px;font-weight:700;width:100%;height:35px;padding-top:15px;}
	
	
	
</style>
<style>
	body,h2,ul,h3 {padding: 0;margin: 0;}

ul {list-style: none outside none;}

.timeline {
	background: url("../../../../img/asset/line4.png") repeat-y 15px 0;
	overflow: hidden;
	position: relative;
	height:100px;
	margin: 20px 10px;
}

.timeline-date {
	overflow: hidden;
	position: relative;
}

.timeline-date h2 {
	background:url("../../../../img/asset/circle_01.png") no-repeat 10px 8px;
	
	margin-bottom: 20px;
}

.timeline-date h2 span {
	color: #FD8921;
	display: inline-block;
	font-size: 16px;
	margin:-30px 0px 0 30px;
}

.timeline-date ul li {
	background: url("../../../../img/asset/circle_02.png") no-repeat 13px 5px;
	zoom: 1;
	height:78px;
}

.timeline-date ul li h3 {
	float: left;
	text-align: right;
	font-size: 14px;
	color: #878787;
	display: block;
}
		
.timeline-date ul li h3 span {
	display: block;
	color: #ADADAD;
	font-size: 12px;
	padding-left:15px;
	margin-left:15px;
}
		
.timeline-date ul li dl {
	margin-top: -5px;
}

.timeline-date ul li dl.right {
	
	float: left;
	margin-left: 0px;
	margin-bottom: 18px;
	display: block;
	
	height:18px;
	
	color:red;
	font-size:12px;
	clear: both;
}
		
.timeline-date ul li dl span{
	display: block;
	font-size:12px;
	padding: 0px 10px 0px 30px;
	color:#333;
	line-height: 40px;

}
</style>
</head>

<body ng-app="projectType" ng-controller="userMgrCtrl">

<div class="all">
	<div class="div1">
		<div class="div1_top">
			<img src="../../../../img/asset/code.png">
		</div>
		<div class="bg1">
		
		</div>
		
		<table class="table1">
			<tr>
				<td class="font1">分类</td>
				<td class="font2">{{lefObj.assetClassName}}</td>
			</tr>
			<tr>
				<td class="font1">品牌</td>
				<td class="font2">{{lefObj.brand}}</td>
			</tr>
			<tr>
				<td class="font1">型号</td>
				<td class="font2">{{lefObj.modelNo}}</td>
			</tr>
			<tr>
				<td class="font1">资产性质</td>
				<td class="font2">{{lefObj.assetCharacterName}}</td>
			</tr>
		</table>
		<hr style="height:1px;border:none;border-top:1px dashed #99C2FF;" />
		<table class="table1">
			<tr>
				<td class="font1">采购时间</td>
				<td class="font2">{{lefObj.datePurchase=='0000-00-00'?'':lefObj.datePurchase}}</td>
			</tr>
			<tr>
				<td class="font1">入库时间</td>
				<td class="font2">{{lefObj.dateStorage=='0000-00-00'?'':lefObj.dateStorage}}</td>
			</tr>
			<tr>
				<td class="font1">使用寿命</td>
				<td class="font2">{{lefObj.dateStorage=='0000-00-00'?'':lefObj.dateStorage}}</td>
			</tr>
			<tr>
				<td class="font1">仪器状态</td>
				<td class="font2">
					<div ng-if="lefObj.status==1">闲置</div>
					<div ng-if="lefObj.status==2">在用（部门）</div>
					<div ng-if="lefObj.status==3">在用（项目）</div>
					<div ng-if="lefObj.status==4">项目维修</div>
					<div ng-if="lefObj.status==5">维修</div>
					<div ng-if="lefObj.status==6">待报废</div>
					<div ng-if="lefObj.status==7">已报废</div>
					<div ng-if="lefObj.status==8">总部仓库闲置</div>
				</td>
			</tr>
			<tr>
				<td class="font1">仪器位置</td>
				<td class="font2">{{lefObj.location}}</td>
			</tr>
		</table>
		<hr style="height:1px;border:none;border-top:1px dashed #99C2FF;" />
		<table class="table1">
			<tr>
				<td class="font1">所属部门</td>
				<td class="font2">{{lefObj.loanUnitName}}</td>
			</tr>
			<tr>
				<td class="font1">所属项目组</td>
				<td class="font2">{{lefObj.loanProName}}</td>
			</tr>
			
			
		</table>
		<hr style="height:1px;border:none;border-top:1px dashed #99C2FF;" />
		<table class="table1">
			<tr>
				<td class="font1">备注</td>
				
			</tr>
			<tr>
				
				<td class="font2">{{lefObj.remarks}}</td>
			</tr>
			
		</table>
	</div>
	<div class="div2">
		<div class="div2_title">
			仪器租用记录
		</div>
		<div class="bg2">
		
		</div>
		
		<div class="timeline">
		    <div class="timeline-date">
			    <ul>
		        	<h2 class="second" style="position: relative;">
		        		<span class="currentYear">2016年</span>
		        	</h2>
		        	
		        	
		        	<li ng-repeat="item in rentList">
		        		<h3><span ng-if="item.returnDate=='' && $index==0 ">至今</span><span ng-if="item.returnDate=='' && $index>0 ">无归还时间</span><span ng-if="item.returnDate!='' ">{{item.returnDate}}</span></h3>
		        		<dl class="right">
	            			<span>{{item.loanProName==""?item.loanUnitName:item.loanProName}}</span>
	          			</dl>
	          			<dl class="right">
	            			<span ng-if="item.rentStatus==0">租期({{item.rentDay}}天) &nbsp;&nbsp;(租用申请)&nbsp;&nbsp;(租用人:{{item.loanEmployeeName}})</span>
	            			<span ng-if="item.rentStatus==1">租期({{item.rentDay}}天) &nbsp;&nbsp;(租用)&nbsp;&nbsp;(租用人:{{item.loanEmployeeName}})</span>
	            			<span ng-if="item.rentStatus==2">租期({{item.rentDay}}天) &nbsp;&nbsp;(退租)&nbsp;&nbsp;(租用人:{{item.loanEmployeeName}})</span>
	            			<span ng-if="item.rentStatus==3">租期({{item.rentDay}}天) &nbsp;&nbsp;(退租申请)&nbsp;&nbsp;(租用人:{{item.loanEmployeeName}})</span>
	          			</dl>
	          			
			        </li>
			       
	      		</ul>
	    	</div>
	    	<div id="yiqi" style="width:100%; text-align: center">
	    		<img alt="" src="../../../../img/asset/default.png" style="margin-top:50px;"  />
				<p>当前列表没有数据!</p>
	    	</div>
		</div>
		
		
	</div>
	<div class="div3">
		<div class="div2_title">
			维修记录
		</div>
		<div class="bg2">
			
		</div>
		
		<div class="timeline">
		    <div class="timeline-date">
			    <ul>
		        	<h2 class="second" style="position: relative;">
		        		<span class="currentYear">2016年</span>
		        	</h2>
		        	
		        	
		        	<li ng-repeat="item in repairList">
		        		<h3><span>{{item.finishDate}}</span></h3>
		        		<dl class="right">
	            			<span>{{item.repairReason}}</span>
	          			</dl>
			        </li>
		        	
	      		</ul>
	    	</div>
	    	<div id="weixiu" style="width:100%; text-align: center">
	    		<img alt="" src="../../../../img/asset/default.png" style="margin-top:50px;"  />
				<p>当前列表没有数据!</p>
	    	</div>
	    	
	    	
		</div>
	</div>
	<div class="div4">
		<div class="div2_title">
			保养记录
		</div>
		<div class="bg2">
		
		</div>
		<div class="timeline">
		    <div class="timeline-date">
			    <ul>
		        	<h2 class="second" style="position: relative;">
		        		<span class="currentYear">2016年</span>
		        	</h2>
		        	
		        	
		        	<li ng-repeat="item in maintainList">
		        		<h3><span>{{item.mtDate}}</span></h3>
		        		<dl class="right">
	            			<span>{{item.mtContent}}</span>
	          			</dl>
			        </li>
		        	
	      		</ul>
	    	</div>
	    	<div id="baoyang" style="width:100%; text-align: center">
	    		<img alt="" src="../../../../img/asset/default.png" style="margin-top:50px;"  />
				<p>当前列表没有数据!</p>
	    	</div>
	    	
	    	
		</div>
		
	</div>
</div>
<script language="javascript">
	  	$(function(){
	  		$(".timeline").animate({
	  			height:'480px'
	  		},1500);
	  	});
  	</script>

<script type="text/javascript">
	var ngScope;
	var app = angular.module("projectType", []);
	app.controller("userMgrCtrl", function($scope, $http){
		/* init */
		ngScope = $scope;
		$scope.rentList=[];//租用记录
		$scope.repairList=[];//维修记录
		$scope.maintainList=[];//保养记录
		$scope.lefObj={}; //左侧数据
		
		var mydate = new Date();
		$(".currentYear").html(mydate.getFullYear());
		
		var userDataStr = $.cookie("pmsWeb_user_data");
		if(!userDataStr){
			
			noLogin(location.href);
			return;
		}
		$scope.userData = jQuery.parseJSON(userDataStr);
		var ticket = $.cookie("pmsWeb_ticket");
		
		var params = getUrlParams();
		$scope.required = params.required;
		
		
		var assetCode = "";
		if(params.assetCode){
			assetCode = params.assetCode; 
			
		}
		
		/* 加载数据 */
		$http.get(serviceBasePath+"eap/pmsServices/materielMg/assetMg/asset/assetLiftCycle?ticket="+ticket+"&assetCode="+assetCode).success(function(response){
			if(response.statusCode==200){
				$scope.lefObj = response.data;
				$scope.rentList = response.data.rentList;
				$scope.repairList = response.data.repairList;
				$scope.maintainList = response.data.maintainList;
				
				if(response.data.rentList.length>0){
					$("#yiqi").hide();
				}else{
				
					$("#yiqi").show();
				}
				
				if(response.data.repairList.length>0){
					$("#weixiu").hide();
				}else{
				
					$("#weixiu").show();
				}
				
				if(response.data.maintainList.length>0){
					$("#baoyang").hide();
				}else{
				
					$("#baoyang").show();
				}
				
			}else if(response.statusCode==401){
				window.parent.location.href="../login.html";
			}else{
				alert("服务器访问出错！");
			}
		});
		/* 选择 */
		$scope.onChoose=function(obj){
			window.frameElement.callback(obj);
			window.frameElement.close();
		};
		/* 选择空白 */
		$scope.onChooseBlank=function(){
			var obj=new Object();
			obj.assetClassName="";
			obj.assetClassCode="";
			window.frameElement.callback(obj);
			window.frameElement.close();
		};
		
	});
	</script>
</body>
</html>
