<!DOCTYPE HTML>
<html>
<head>
<title>项目类型管理 </title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<script type="text/javascript" src="../../../js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../../../js/jquery.cookie.js"></script>
<script type="text/javascript" src="../../../angular-1.4.6/angular.min.js"></script>
<script type="text/javascript" src="../../../js/PageBar.js"></script>
<script type="text/javascript" src="../../../js/DropDownList-1.2/DropDownList-v1.2.js"></script>
<link rel="stylesheet" type="text/css" href="../../../js/DropDownList-1.2/DropDownList.css" />
<script type="text/javascript" src="../../../js/config.js"></script>
<script type="text/javascript" src="../../../js/util.js"></script>
<script type="text/javascript" src="../../../js/ng-base.js"></script>
<script type="text/javascript" src="../../../js/ViewState.js"></script>
<script type="text/javascript" src="../../../js/showDlog/showDlog.js"></script>
<link rel="stylesheet" type="text/css" href="../../../js/showDlog/showDlog-blue.css" />
<link rel="stylesheet" type="text/css" href="../../../css/list.css" />


<style type="text/css">
	.btn{display:inline-block;padding:1px 4px;border:solid 1px #f4f4f4; border-radius:4px;}
	.btn.toactive{color:#fff;background:green;}
	.btn.toclose{color:#fff;background:#ED7798;}
	
	.switch_btn_group{border:solid 1px #3385FF;min-height:30px;float:left;border-radius:15px; position:absolute;right:10px;top:0px;}
	.switch_btn_group a{display:inline-block;float:left;background:#fff;color:#3385FF;text-decoration:none;font-size:13px;
		line-height:30px;text-align:center;margin:0 1px 0 0;min-width:60px;}
	.switch_btn_group a.selected{background:#3385FF;color:#fff;}
	.switch_btn_group a:first-of-type{border-top-left-radius:15px;border-bottom-left-radius:15px;}
	.switch_btn_group a:last-of-type{border-top-right-radius:15px;border-bottom-right-radius:15px;margin:0;}
	
	.title_add2{
		float: left;
	    width: 200px;
	    height: 28px;
	    line-height: 28px;
	    text-align: center;
	    margin-top: 5px;
	    color: #3385ff;
	    cursor: pointer;
	    font-size: 16px;
	}
	
	.title_add3
	   {
    width: 70px;
    height: 28px;
    line-height: 28px;
    text-align: center;
    margin-right: 30px;
    color: rgb(255, 255, 255);
    cursor: pointer;
    background: url(../../../img/btn_add.png) repeat;
}
</style>
</head>

<body ng-app="moduleName" ng-controller="controllerName" storagekey="pm.baseMgr.pmProKpiMgr">

<div class="list">
	<div class="list_content">
	<div class="title_div">
			<div class="title_left">
				<input type="text" class="dropDownProjectType" style="width:120px;" placeholder="项目类别"/>
				<input type="text"  class="dropDownTree dropDownList" style="width:200px;" placeholder="请选择项目"/>
				<div class="query_div" ng-click="doQuery()">
					查询
				</div>
				&nbsp;&nbsp;&nbsp;&nbsp;
			</div>
			<img src="../../../img/list_Header2-.png">
	</div>
	<iframe id="frame1" name="frame1" src="pmProKpiMgrIframe.html?categoryCode=&proNo=" width="100%" height="100%" frameborder="0"></iframe>
	</div>
</div>
<script type="text/javascript">

var cond_categoryCode="";
var cond_categoryName="";

var proNo="";//项目
var proName="";

simpleController({init:function($scope, $http){
	/* init */
	var proUrl="../../component/projectList.html";

	/* 项目类型 */
	new DropDownList().init({
		renderTo:".dropDownProjectType",
		url:"../../component/projectType.html?required=false&ticket="+$scope.ticket,
		height:"200px",
		onSelected:function(result){
			$(".dropDownProjectType").val(result.categoryName);
			cond_categoryCode = result.categoryCode;
			cond_categoryName =result.categoryName ;
			/* 联动 */
			projectList.setConfig("url", proUrl+"?categoryCode="+cond_categoryCode+"&required=false&ticket="+$scope.ticket);
		}
	});
	
	/* 项目列表 */
	var projectList = new DropDownList();
	projectList.init({
		renderTo:".dropDownTree",
		url:proUrl+"?categoryCode="+cond_categoryCode+"&required=false&ticket="+$scope.ticket,
		height:"200px",
		onSelected:function(result){
			$(".dropDownTree").val(result.proName);
			proNo=result.proNo;
			proName=result.proName;
			$scope.doQuery();
		}
	});
	
	$scope.doQuery=function(){
		if(cond_categoryCode=='' && proNo=='' )
		{
			new ShowDlog().prompt({
						icon:"success",
						msg:"请选择项目分类和项目名称！",
						done:function(){
							
						},
						t:1500
					});
		}
		else
		{
			$("#frame1").attr('src','pmProKpiMgrIframe.html?categoryCode='+cond_categoryCode+"&proNo="+proNo);	
		}
		
	  
	};
	
	
	
}});
</script>
</body>
</html>
