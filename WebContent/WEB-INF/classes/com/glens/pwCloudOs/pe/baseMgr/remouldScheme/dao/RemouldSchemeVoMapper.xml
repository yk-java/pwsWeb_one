<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.glens.pwCloudOs.pe.baseMgr.remouldScheme.dao.RemouldSchemeVoMapper" >
  <resultMap id="BaseResultMap" type="com.glens.pwCloudOs.pe.baseMgr.remouldScheme.vo.RemouldSchemeVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="rowid" property="rowid" jdbcType="BIGINT" />
    <result column="COMPANY_CODE" property="companyCode" jdbcType="VARCHAR" />
    <result column="REMOULDSCHEME_CODE" property="remouldSchemeCode" jdbcType="VARCHAR" />
    <result column="REMOULDSCHEME_NAME" property="remouldSchemeName" jdbcType="VARCHAR" />
    <result column="REMOULDSCHEME_DESC" property="remouldSchemeDesc" jdbcType="VARCHAR" />
    <result column="REMARKS" property="remarks" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
 COMPANY_CODE,REMOULDSCHEME_CODE,REMOULDSCHEME_NAME,REMOULDSCHEME_DESC,REMARKS
  </sql>
  
  <select id="queryForCount" parameterType="java.util.HashMap" resultType="int">
  	select count(*) 
  	from PE_BS_RP_REMOULDSCHEME 
  	where COMPANY_CODE=#{companyCode} AND  SYS_PROCESS_FLAG='1'
  	<if test="remouldSchemeName != null and remouldSchemeName != ''">
    and REMOULDSCHEME_NAME like "%"#{remouldSchemeName}"%"
    </if>
  </select>
  
  <select id="queryForPage" parameterType="java.util.HashMap" resultMap="BaseResultMap">
  	select 
    <include refid="Base_Column_List" />
    from PE_BS_RP_REMOULDSCHEME 
  	where COMPANY_CODE=#{companyCode} AND  SYS_PROCESS_FLAG='1'
  	<if test="remouldSchemeName != null and remouldSchemeName != ''">
    and REMOULDSCHEME_NAME like "%"#{remouldSchemeName}"%"
    </if>
  	limit #{firstResult},#{maxResult}
  </select>
  
  <select id="queryMaterialType" resultType="map" parameterType="map">
  	select m.MATERIALTYPE_CODE  typeCode,m.MATERIALTYPE_NAME typeName,g.REMOULDSCHEME_CODE remouldschemecode,g.NEED_COUNT needcount from pe_bs_rp_materialtype m
left join pe_bs_rp_rs_mt_gxb g on g.MATERIALTYPE_CODE=m.MATERIALTYPE_CODE
	where m.COMPANY_CODE=#{companyCode} 
	<if test="remouldSchemeCode != null and remouldSchemeCode != ''">
   	 and g.REMOULDSCHEME_CODE=#{remouldSchemeCode}
    </if>
  </select>
  
  <select id="getALLType" resultType="map" parameterType="map">
  	select m.MATERIALTYPE_CODE  typeCode,m.MATERIALTYPE_NAME typeName from pe_bs_rp_materialtype m
	where m.COMPANY_CODE=#{companyCode} 
	
	
	
  </select>
  
  <insert id="addMaterial" parameterType="map">
   insert into pe_bs_rp_rs_mt_gxb(COMPANY_CODE,REMOULDSCHEME_CODE,MATERIALTYPE_CODE,NEED_COUNT,SYS_CREATE_TIME,SYS_PROCESS_FLAG)
	VALUES(#{companyCode},#{remouldSchemeCode},#{materialTypeCode},#{needcount},NOW(),'1')
  </insert>
 
  
  
  
  <select id="findById" resultMap="BaseResultMap" parameterType="com.glens.pwCloudOs.pe.baseMgr.remouldScheme.vo.RemouldSchemeVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
   from PE_BS_RP_REMOULDSCHEME 
  	where COMPANY_CODE=#{companyCode} AND  SYS_PROCESS_FLAG='1'
    and  REMOULDSCHEME_CODE = #{remouldSchemeCode}
  </select>
  <delete id="delete" parameterType="com.glens.pwCloudOs.pe.baseMgr.remouldScheme.vo.RemouldSchemeVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from PE_BS_RP_REMOULDSCHEME
    where REMOULDSCHEME_CODE = #{remouldSchemeCode}
  </delete>
   <delete id="deleteMaterial" parameterType="map" >
    
    delete from pe_bs_rp_rs_mt_gxb where REMOULDSCHEME_CODE=#{remouldSchemeCode}
    
  </delete>
  
  
  <insert id="insert" parameterType="com.glens.pwCloudOs.pe.baseMgr.remouldScheme.vo.RemouldSchemeVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    INSERT INTO PE_BS_RP_REMOULDSCHEME(COMPANY_CODE,REMOULDSCHEME_CODE,REMOULDSCHEME_NAME,REMOULDSCHEME_DESC,SYS_CREATE_TIME,SYS_PROCESS_FLAG,REMARKS)
VALUES(#{companyCode},#{remouldSchemeCode},#{remouldSchemeName},#{remouldSchemeDesc},now(),'1',#{remarks})

  </insert>
  
  <update id="update" parameterType="com.glens.pwCloudOs.pe.baseMgr.materialType.vo.MaterialTypeVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update PE_BS_RP_REMOULDSCHEME
    <set >
      <if test="remouldSchemeName != null" >
        REMOULDSCHEME_NAME = #{remouldSchemeName,jdbcType=VARCHAR},
      </if>
      <if test="remouldSchemeDesc != null and remouldSchemeDesc !=''">
      REMOULDSCHEME_DESC = #{remouldSchemeDesc},
      </if>
      
      <if test="remarks != null" >
        REMARKS = #{remarks,jdbcType=VARCHAR},
      </if>
      SYS_UPDATE_TIME = now()
    </set>
    where REMOULDSCHEME_CODE = #{remouldSchemeCode}
  </update>
  
</mapper>