<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.glens.pwCloudOs.pm.taskMgr.mctMgr.dao.MctVoMapper" >
  <resultMap id="BaseResultMap" type="com.glens.pwCloudOs.pm.taskMgr.mctMgr.vo.MctVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="rowid" property="rowid" jdbcType="BIGINT" />
    <result column="COMPANY_CODE" property="companyCode" jdbcType="VARCHAR" />
    <result column="PRO_NO" property="proNo" jdbcType="VARCHAR" />
     <result column="PRO_NAME" property="proName" jdbcType="VARCHAR" />
    <result column="MCT_CODE" property="mctCode" jdbcType="VARCHAR" />
    <result column="MCT_NAME" property="mctName" jdbcType="VARCHAR" /> 
    <result column="ENABLE_OM_MODEL" property="enableOmModel" jdbcType="INTEGER" /> 
    <result column="DEVICE_TYPE_CODE" property="deviceTypeCode" jdbcType="VARCHAR" />     
    <result column="DEVICE_TYPE_NAME" property="deviceTypeName" jdbcType="VARCHAR" />
    <result column="REMARKS" property="remarks" jdbcType="VARCHAR" />    
    
  </resultMap>
  
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     m.rowid,m.PRO_NO,b.PRO_NAME,m.MCT_CODE,m.MCT_NAME,m.ENABLE_OM_MODEL,m.DEVICE_TYPE_CODE,d.DEVICE_TYPE_NAME,m.REMARKS

  </sql>
  
  <select id="queryForCount" parameterType="java.util.HashMap" resultType="int">
  	select count(*) from pm_mct b join pm_base  c  on b.PRO_NO=c.PRO_NO
  	where b.SYS_PROCESS_FLAG='1' 
  	<if test="proNo != null and proNo != ''">
  	 and b.PRO_NO=#{proNo}
  	</if>
  	<if test="enableOmModel != null and enableOmModel != ''">
  	 and b.PRO_NO=#{enableOmModel}
  	</if>
  	<if test="deptCode != null and deptCode != ''">
		and c.MANAGE_DEPT=#{deptCode}
    </if>
  </select>
  
  <select id="queryForPage" parameterType="java.util.HashMap" resultMap="BaseResultMap">
  	select 
    <include refid="Base_Column_List" />
    from pm_mct m LEFT JOIN PM_BASE b on b.PRO_NO=m.PRO_NO
	LEFT JOIN power_device_type d ON d.DEVICE_TYPE_CODE=m.DEVICE_TYPE_CODE
    where m.SYS_PROCESS_FLAG='1' 
   <if test="proNo != null and proNo != ''">
  	 and m.PRO_NO=#{proNo}
  	</if>
  	<if test="enableOmModel != null and enableOmModel != ''">
  	 and m.PRO_NO=#{enableOmModel}
  	</if>
  	<if test="deptCode != null and deptCode != ''">
		and b.MANAGE_DEPT=#{deptCode}
    </if>
  	limit #{firstResult},#{maxResult}
  </select>
  
  <select id="queryForList" parameterType="java.util.HashMap" resultMap="BaseResultMap">
  	select 
    <include refid="Base_Column_List" />
    from pm_mct m LEFT JOIN PM_BASE b on b.PRO_NO=m.PRO_NO
	LEFT JOIN power_device_type d ON d.DEVICE_TYPE_CODE=m.DEVICE_TYPE_CODE
    where m.SYS_PROCESS_FLAG='1' 
    and m.COMPANY_CODE = #{companyCode}
   <if test="proNo != null and proNo != ''">
  	 and m.PRO_NO=#{proNo}
  	</if>
  	<if test="enableOmModel != null and enableOmModel != ''">
  	 and m.PRO_NO=#{enableOmModel}
  	</if>
  </select>
  
  <delete id="delete" parameterType="com.glens.pwCloudOs.pm.taskMgr.mctMgr.vo.MctVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update pm_mct set sys_process_flag='0', SYS_DELETE_TIME=now()
    where MCT_CODE = #{mctCode}
  </delete>
  <insert id="insert" parameterType="com.glens.pwCloudOs.pm.taskMgr.mctMgr.vo.MctVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->

   INSERT INTO pm_mct(COMPANY_CODE,PRO_NO,MCT_CODE,MCT_NAME,ENABLE_OM_MODEL,DEVICE_TYPE_CODE,SYS_CREATE_TIME,SYS_PROCESS_FLAG,REMARKS)
   VALUES(#{companyCode},#{proNo},#{mctCode},#{mctName},#{enableOmModel},#{deviceTypeCode},NOW(),'1',#{remarks})
    
  </insert>
  
   <update id="update" parameterType="com.glens.pwCloudOs.pm.taskMgr.mctMgr.vo.MctVo" >
  		update pm_mct set 
  		PRO_NO=#{proNo},
  		MCT_NAME=#{mctName},
  		ENABLE_OM_MODEL=#{enableOmModel},
  		DEVICE_TYPE_CODE=#{deviceTypeCode},
  		SYS_UPDATE_TIME=now(),
  		REMARKS=#{remarks}
  		where MCT_CODE=#{mctCode}
  </update>
  
   <select id="findById" resultMap="BaseResultMap" parameterType="com.glens.pwCloudOs.pm.taskMgr.mctMgr.vo.MctVo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from pm_mct m LEFT JOIN PM_BASE b on b.PRO_NO=m.PRO_NO
	LEFT JOIN power_device_type d ON d.DEVICE_TYPE_CODE=m.DEVICE_TYPE_CODE
    where m.SYS_PROCESS_FLAG='1' 
    and  m.MCT_CODE = #{mctCode}
  </select>
  
 
  
</mapper>