<!DOCTYPE html>
<html ng-app="moduleName">
<head>
<meta charset="UTF-8">
<title> 问卷答案查看 </title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<script type="text/javascript" src="../../js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../../js/jquery.cookie.js"></script>
<script type="text/javascript" src="../../bootstrap-3.3.5-dist/js/bootstrap.min.js"></script></head>
<script type="text/javascript" src="../../angular-1.4.6/angular.min.js"></script>
<script type="text/javascript" src="../../js/PageBar.js"></script>
<script type="text/javascript" src="../../js/DropDownList-1.2/DropDownList-v1.2.js"></script>
<link rel="stylesheet" type="text/css" href="../../js/DropDownList-1.2/DropDownList.css"/>
<script type="text/javascript" src="../../js/Calendar.js"></script>
<script type="text/javascript" src="../../js/config.js"></script>
<script type="text/javascript" src="../../js/util.js"></script>
<script type="text/javascript" src="../../js/ng-base.js"></script>

<script type="text/javascript" src="../../js/eapJs/core/eap.core.js" ></script>
<script type="text/javascript" src="../../js/eapJs/plugins/eap.tip.js" ></script>
<script type="text/javascript" src="../../js/eapJs/plugins/eap.validate.js"></script>
<script type="text/javascript" src="../../js/eapJs/local/eap.lang-zh_CN.js"></script>
<link rel="stylesheet" type="text/css" href="../../css/common.css"/>
<link rel="stylesheet" type="text/css" href="../../css/validate.css"/>
<link rel="stylesheet" type="text/css" href="../../css/edit.css"/>

<script type="text/javascript" src="../../js/showDlog/showDlog.js"></script>
<link rel="stylesheet" type="text/css" href="../../js/showDlog/showDlog-blue.css" />
<style type="text/css">
	ul,li{margin:0;padding:0;}
	.list{padding: 0;margin: 0;top: 0;right: 0;bottom: 0;left: 0;overflow-y: auto;}
	.list .list_content .title_div{height: 60px;}
	.title_divtop{position: fixed;z-index: 100;top: 0;}
	.list .list_content .title_div .title_left{line-height: 65px;height: 60px;font-size: 20px;font-weight: normal;background:#02a2ff;}
	.title_save{display:inline-block;width:70px;height:28px;background: url(../../img/btn_save.png) no-repeat 0 0;line-height:28px;text-align:center;margin-left:10px;margin-top:5px;color:#fff;cursor: pointer;}
	.title_save:hover{background: url(../../img/btn_save.png) no-repeat 0 -29px;}
	.title_cancel{display:inline-block;width:70px;height:28px;background: url(../../img/btn_cancel.png) no-repeat 0 0;line-height:28px;text-align:center;margin-left:10px;margin-top:5px;color:#666;cursor: pointer;}
	.title_cancel:hover{background: url(../../img/btn_cancel.png) no-repeat 0 -29px;}
	.title_left .return img{width: 13px;}
	.bottom_space{float:left;width:100%;height:80px; }
	.preview_box{width:90%;padding:10px 10px;position:relative;margin:0 auto}
	.preview_box.selected{background:#FFF8CB;border:solid 1px #ff9900;margin:0 -1px;}
	
	.questionnire{float:left;}
	.questionnire_title>h2{text-align:center;}
	.questionnire_descr>p{text-indent:24px;line-height:22px;color:#666;}
	.enabled_time{text-align:center;color:#888;}
	.form_div{padding-top:80px}
	.group{float:left;}
	.title_left .return{position: absolute;left: 10px;top: 3px;width: 23px;height: 41px;}
	.question{float:left;}
/* 	.question .num{width:30px;float:left;} */
	.question .question_body{width:100%;float:left;}
	.question .question_body .question_title{}
	.question .question_body .question_options{}
	.question .question_body .question_options ul li{float:left;list-style-type:none;margin:4px 4px 4px 0;}
	.edit_box.question .question_body .question_options ul li{float:left;width:100%;list-style-type:none;margin:4px 10px 4px 0;}
	.question .question_body .question_options textarea{width:100%;height: 60px;}
	.question .question_body .question_options .supplement{border:0;border-bottom:solid 1px;width:220px;}
	.radio{}
	.checkbox{}
	.text{}
	.Submit_btn{line-height: 40px;text-align: center;background: #4ca9ff;width: 90%;margin: 0 auto;color: #fff;font-size: 18px;}
	
</style>
</head>
<body ng-controller="controllerName" storagekey="questionnire.questionnireMgr.questionnireEdit">
<div class="list">
	<div class="list_content">
		<div class="title_div title_divtop">
			<div class="title_left" style="float:none;text-align:center;">
				<a class="return"><img src="../../img/return.png"></a>
				调查问卷
			</div>
		</div>
		
		<form id="saveForm" class="required-validate">
		<div class="form_div questionnire" id="lay1">
			<div partner="questionnire_title" class="preview_box questionnire_title">
				<h2>{{questionnire.title}}</h2>
			</div>
			<div partner="questionnire_descr" class="preview_box questionnire_descr">
				<p>{{questionnire.descr}}</p>
			</div>
			<div partner="enabled_time" class="preview_box enabled_time">
				<div>问卷有效时间（启于 {{questionnire.enabledBeginTime}} 止于 {{questionnire.enabledEndTime}}）</div>
			</div>
			
			
			<div ng-repeat="question in questionnire.questions track by $index" partner="item_{{question.idx}}" class="preview_box {{question.type}} {{question.subType?question.subType:''}}">
				<!-- group/title -->
				<div ng-if="question.type=='group'" class="title"><h2>{{question.num}}、{{question.title}}</h2></div>
				<!-- question -->
				<div ng-if="question.type=='question'" class="question_body">
					<div class="question_title"><h3>{{question.num}}. {{question.title}}</h3></div>
					<div ng-if="question.subType=='radio'" class="question_options">
						<ul>
							<li ng-repeat="option in question.options">
								<label><input type="radio" name="q{{question.num}}" disabled="disabled" value=1 ng-model="option.isAnswer"/>{{option.num}}. {{option.optionLabel}}</label>
								<input ng-if="option.isSupplement" name="q{{question.num}}_supplement" readonly="readonly" value="{{option.supplement}}" class="supplement">
							</li>
						</ul>
					</div>
					<div ng-if="question.subType=='checkbox'" class="question_options">
						<ul>
							<li ng-repeat="option in question.options">
								<label><input type="checkbox" name="q{{question.num}}" disabled="disabled" ng-true-value="1" ng-false-value="" ng-model="option.isAnswer"/>{{option.num}}. {{option.optionLabel}}</label>
								<input ng-if="option.isSupplement" name="q{{question.num}}_supplement" readonly="readonly" value="{{option.supplement}}" class="supplement">
							</li>
						</ul>
					</div>
					<div ng-if="question.subType=='text'" class="question_options">
						<textarea name="q{{question.num}}" readonly="readonly" class="readonly">{{question.answer}}</textarea>
					</div>
				</div>
			</div>
			
			
		</div>
		<div class="bottom_space">
			<div class="Submit_btn" ng-click="onCancel()">返&nbsp;&nbsp;回</div>
		</div>
		</form>
	</div>
</div>
<script type="text/javascript">
simpleController({
	init:function($scope, $http){
		$scope.questionnire={};
		var urlParams = getUrlParams();
		
		/* 初始化（查询） */
		$scope.init=function(){
			new ShowDlog().prompt({
				icon:"waitting",
				msg:"正在查询...",
				done:function(){},
				t:20*60*1000
			});
			$scope.httpExecute({
				url:"eap/pmsServices/questionnireStatistic/getUserAnswer",
				method:"GET",
				data:{"questionnireCode":urlParams.questionnireCode, "submitUser":urlParams.employeeCode},
				success:function(res){
					$dlog.close();
					if(res.statusCode==200){
						$scope.questionnire=res.data;
					}
				},
				error:function(){
					$dlog.close();
					new ShowDlog().prompt({
						msg:"网络异常",
						done:function(){},
						t:1500
					});
				}
			});
		};
		
		/* 取消 */
		$scope.onCancel=function(){
			history.go(-1);
		};
		$scope.init();
	}
});
$(".return").click(function(){
	top.viewBack(); 
});	
</script>
</body>
</html>